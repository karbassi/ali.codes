var Chrysler=window.Chrysler||{};Chrysler.config=window.Chrysler.config||{};Chrysler.config.vidAutoInit=(typeof window.Chrysler.config.vidAutoInit==="undefined")?true:window.Chrysler.config.vidAutoInit;Chrysler.Video=(function(j,k,n){var a="ChryslerVid",r={classes:{playlist:"chrysler-video-playlist",endcard:"chrysler-video-endcard",nextCTA:"chrysler-video-next",prevCTA:"chrysler-video-prev",replayCTA:"chrysler-video-replay",transcript:"chrysler-video-transcript",transcriptCTA:"transcript-button"},selectors:{player:"video",playlistItem:"li",endcardSocialCTA:".social",endcardVideoCTA:".next-steps"},player:{id:"",mediaElement:"","$el":"",trackingid:"",title:"",elapsedtime:0,totalDuration:0,position:0,percents:[],percent:0,status:"pause",mAttr:"",playlistLength:0,width:640,height:360,features:["playpause","current","progress","duration","volume","fullscreen"],alwaysShowControls:false,autosizeProgress:true,plugins:(mejs.MediaFeatures.isIE)?["flash","youtube","vimeo","silverlight"]:["youtube","flash","vimeo","silverlight"],video_title:""},events:{onPlay:"onplay.video.chrysler",onPause:"onpause.video.chrysler",onEnded:"onended.video.chrysler",onUpdate:"onupdate.video.chrysler",onError:"onerror.video.chrysler",onVolumeChange:"onvolchange.video.chrysler",onCreated:"oncreated.video.chrysler",onSocialCTA:"onsocialcta.video.chrysler"},states:{touch:false},assetpath:"/crossbrand/video/assets/",pluginpath:"/crossbrand/video/assets/"};function b(D,C){this.el=D;this.$cache={el:j(D),playlist:"",endcard:"",endcardNextCTA:"",endcardPrevCTA:""};this.options=j.extend(true,{},r,C);this.options.player.$el=this.$cache.el.find(this.options.selectors.player);this.options.player.id=this.options.player.$el[0].id;this.options.player.trackingid=this.$cache.el.data().trackingid;this.$cache.playlist=this.$cache.el.find("."+this.options.classes.playlist);this.$cache.endcard=this.$cache.el.find("."+this.options.classes.endcard);this.$cache.transcript=this.$cache.el.find("."+this.options.classes.transcript);this._defaults=r;this._name=a;if(n.Modernizr){this.options.states.touch=Modernizr.touch;}else{if(("ontouchstart" in n)||n.DocumentTouch&&document instanceof DocumentTouch){this.options.states.touch=true;}}this.init();j(".litebox_container").on("click",".chrysler-watch-next",function(){console.log(this);});}function w(C){C=C.replace(/ /g,"_");C=C.replace(/-/g,"");C=C.replace(/\//g,"_");C=C.replace(/\|/g,"_");C=C.toLowerCase();return C;}function f(H,D,J){var C=j(H.container),I=j(H.controls),G="video_controls",K="player_"+w(D.trackingid),F={n:"",a1:G,a2:"",a3:D.video_title,a4:K},E=J.options.player.mediaElement||undefined;if(E&&(mejs.MediaFeatures.isiPad||C.find("iframe.me-plugin").length>0)){if(mejs.MediaFeatures.isiPad){I.hide();}E=E.media.pluginApi;E.addEventListener("onStateChange",function(L){switch(L.data){case -1:break;case 0:break;case 1:e(F,J.options.player.mediaElement,J.options.player.mediaElement.media,J);n.linkTrack(F,true);break;case 2:e(F,J.options.player.mediaElement,J.options.player.mediaElement.media,J);n.linkTrack(F,true);break;case 3:break;case 5:break;default:break;}});}else{I.delegate(".mejs-playpause-button","click",function(L){h(L,F,J);}).delegate(".mejs-time-rail","mouseup",function(L){A(L,F,J);}).delegate(".mejs-volume-button","click",function(L){m(L,F);}).delegate(".mejs-volume-slider","click",function(L){p(L,F);}).delegate(".mejs-fullscreen-button","click",function(L){l(L,F);});C.delegate(".me-plugin","mousedown",function(L){v(L,F,J);}).delegate(".mejs-overlay-play","click",function(L){v(L,F,J);});}J.$cache.el.trigger(J.options.events.onCreated);}function c(C){C.$cache.endcard.hide();if(C.options.states.touch){i(C);}}function t(C){var D=C.$cache.playlist.find(".active").index();if(D===0){C.$cache.endcardPrevCTA.hide();}else{if(D===C.options.player.playlistLength-1){C.$cache.endcardNextCTA.hide();}else{C.$cache.endcardPrevCTA.show();C.$cache.endcardNextCTA.show();}}}function o(C){C.options.player.mediaElement.container.animate({top:C.options.player.height});}function i(C){C.options.player.mediaElement.container.animate({top:0});}function B(G,E,D,F){var C=(typeof G.currentTarget!=="undefined")?j(G.currentTarget):j(G);D.remove();D.$cache.el.find("."+D.options.classes.playlist).find(".active").removeClass("active");D.options.player.status="pause";c(D);C.addClass("active");if(F){n.linkTrack("video_playlist",E.caption+"_"+E.src);}D.setupVideo({src:E.src,type:E.type,title:E.caption,poster:E.poster}).createMe(true);}function d(D,E,C){C.$cache.el.trigger(C.options.events.onPlay);}function g(D,C){C.$cache.el.trigger(C.options.events.onError);}function y(D,C){C.$cache.el.trigger(C.options.events.onPause);}function u(F,I,E){var G,C,D,H;E.options.player.totalDuration=Math.round(I.duration);G=Math.round((I.currentTime/I.duration)*100);D=F.elapsedtime=Math.round(I.currentTime);C=G;H=I.seeking;E.options.player.percent=parseInt(G,10)||0;if((G%10===0)&&(G!==100)&&(G!==0)&&(D!==0)&&(H===false)&&(z(G,E.options.player.percents)===-1)){E.options.player.percents.push(G);n.mediaTrack(E.options.player.video_title,E.options.player.mAttr+",duration_"+E.options.player.totalDuration+",elapsedtime_"+D,G,"");}E.$cache.el.trigger(E.options.events.onUpdate);}function z(C,D){if(typeof Array.prototype.indexOf==="function"){return D.indexOf(C);}else{return j.inArray(C,D);}return -1;}function x(D,C){if(C.$cache.endcard.length!==0){if(C.options.player.playlistLength>1){t(C);}C.$cache.endcard.show();if(C.options.states.touch){o(C);}setTimeout(function(){C.stop();},250);}n.mediaTrack(C.options.player.video_title,C.options.player.mAttr+",duration_"+C.options.player.totalDuration+",elapsedtime_"+C.options.player.elapsedtime,"100","complete");C.$cache.el.trigger(C.options.events.onEnded);}function q(C){C.$cache.el.trigger(C.options.events.onVolumeChange);}function s(E,C){E.preventDefault();var D=j(C).closest(".chrysler-video-transcript"),F;if(D.hasClass("show")){F="hide_transcript";D.removeClass("show").find(".transcript-button").text("Show Transcript").data({lid:F});if(this.options.states.touch){i(this);}}else{F="show_transcript";D.addClass("show").find(".transcript-button").text("Hide Transcript").data({lid:F});if(this.options.states.touch){o(this);}}n.linkTrack("ram_video_player",F);}function A(D,E,C){C.options.player.percents=[];E.a2="scrub";n.linkTrack(E,true);}function h(G,H,C){var F=j(G.currentTarget),D=C.options.player.mediaElement,E=D.media;e(H,D,E,C);n.linkTrack(H,true);}function m(D,E){var C=j(D.currentTarget);if(C.hasClass("mejs-unmute")){E.a2="mute";}else{E.a2="unmute";}n.linkTrack(E,true);}function p(C,D){C.preventDefault();C.stopPropagation();D.a2="volume_slider";n.linkTrack(D,true);}function l(C,D){D.a2="full_screen";n.linkTrack(D,true);}function v(F,G,C){if(!C.options.player.mediaElement.isFullScreenHover){var D=C.options.player.mediaElement,E=D.media;if(C.options.player.status==="pause"){G.a2="overlay_play";}else{G.a2="overlay_pause";}n.linkTrack(G,true);e(G,D,E,C);}}function e(F,D,E,C){C.options.player.totalDuration=Math.round(E.duration);if(C.options.player.status==="pause"){F.a2="play";if(!C.options.player.elapsedtime||C.options.player.elapsedtime<=1){C.options.player.status="start";}else{C.options.player.status="resume";}n.mediaTrack(C.options.player.video_title,C.options.player.mAttr+",duration_"+C.options.player.totalDuration+",elapsedtime_"+C.options.player.elapsedtime,C.options.player.percent,C.options.player.status);}else{C.options.player.status=F.a2="pause";if(C.options.player.totalDuration!==C.options.player.elapsedtime){n.mediaTrack(C.options.player.video_title,C.options.player.mAttr+",duration_"+C.options.player.totalDuration+",elapsedtime_"+C.options.player.elapsedtime,C.options.player.percent,C.options.player.status);}}}b.prototype.init=function(){var C=this.$cache.el.data();if(this.$cache.playlist.length!==0){this.setupPlaylist();}if(this.$cache.endcard.length!==0){this.setupEndCard();}if(this.$cache.transcript.length!==0){this.setupTranscript();}this.setupVideo({src:C.src,type:C.type,title:w(C.caption),poster:C.poster}).createMe(false);return this;};b.prototype.setupPlaylist=function(){var I=this.$cache.el.find("."+this.options.classes.playlist+" "+this.options.selectors.playlistItem),E=0,H=this.options.player.playlistLength=I.length,G=this;for(E;E<H;E++){var J=j(I[E]),K=J.data(),C,D,F;if(K.type==="video/youtube"){K.poster="http://i3.ytimg.com/vi/"+K.src+"/hqdefault.jpg";J.data("poster",K.poster);}C=j("<img />",{src:K.poster,"class":"poster"});D=j("<span />",{"class":"caption",html:K.caption});F=j("<img />",{src:this.options.assetpath+"play-btn.jpg","class":"play-btn"});J.append(C,D,F);}this.$cache.el.find("."+this.options.classes.playlist).on("click",this.options.selectors.playlistItem,function(L){B(L,j(L.currentTarget).data(),G,true);});return this;};b.prototype.setupEndCard=function(){var E=this,D=E.options.player,C=null;this.$cache.endcardNextCTA=this.$cache.endcard.find("."+this.options.classes.nextCTA);this.$cache.endcardPrevCTA=this.$cache.endcard.find("."+this.options.classes.prevCTA);if(this.options.player.playlistLength<=1){this.$cache.endcardNextCTA.hide();this.$cache.endcardPrevCTA.hide();}this.$cache.el.on("click","."+E.options.classes.replayCTA,function(G){G.preventDefault();c(E);if(E.$cache.playlist.length>0){C=E.$cache.playlist.find(".active");B(C[0],C.data(),E,false);}else{var F=E.$cache.el.data();E.remove();E.setupVideo({src:F.src,type:F.type,title:F.caption,poster:F.poster}).createMe(true);}if(E.options.states.touch){E.showVideo(E);}}).on("click","."+E.options.classes.nextCTA,function(F){F.preventDefault();c(E);C=E.$cache.playlist.find(".active").next();if(C.length!==0){B(C[0],C.data(),E,false);}}).on("click","."+E.options.classes.prevCTA,function(F){F.preventDefault();c(E);C=E.$cache.playlist.find(".active").prev();if(C.length!==0){B(C[0],C.data(),E,false);}});return this;};b.prototype.setupVideo=function(C){for(var D=0;D<mejs.players.length;D++){if(mejs.players[D].id===this.options.player.mediaElement.id){mejs.players.splice(D,1);}}delete this.options.player.mediaElement;this.$cache.el.find(".mejs-container, video").remove();this.options.player.$el=j("<video />",{id:this.options.player.id,preload:"none"});this.$cache.el.prepend(this.options.player.$el);this.options.player.mAttr="brand_"+context.brand+",player_"+this.options.player.trackingid+",filepath_"+C.src;this.options.player.video_title=C.title;this.options.player.poster=C.poster;if(C.type==="video/youtube"){C.src="http://www.youtube.com/watch?v="+C.src;}if(this.options.autoplay!=="undefined"&&this.options.autoplay===true&&!this.options.states.touch){this.options.player.$el.attr({autoplay:"true"});}this.options.player.$el.children().remove().end().append(j("<source />",{src:C.src,type:C.type}));return this;};b.prototype.createMe=function(D){var C=this;this.options.player.percents=[];this.options.player.mediaElement=new MediaElementPlayer("#"+this.options.player.id,{success:function(I,H,G){var F={play:function(){d(C.options.player,I,C);},error:function(){g(C.options.player,C);},pause:function(){y(C.options.player,C);},timeupdate:function(){u(C.options.player,I,C);},ended:function(){x(C.options.player,C);},volumechange:function(){q(C);}};for(var E in F){if(F.hasOwnProperty(E)){I.addEventListener(E,F[E],false);}}f(G,C.options.player,C);if(C.options.autoplay&&C.options.player.mediaElement.media.pluginType==="youtube"&&!C.options.states.touch){setTimeout(function(){C.$cache.el.find(".mejs-overlay-button").trigger("click");},100);}},defaultVideoWidth:this.options.player.width,defaultVideoHeight:this.options.player.height,pluginPath:this.options.pluginpath,features:this.options.player.features,alwaysShowControls:this.options.player.alwaysShowControls,autosizeProgress:this.options.player.autosizeProgress,error:function(E){throw new Error("Chrysler Video ERROR :: Unable to load MediaElementPlayer");},plugins:this.options.player.plugins});return this;};b.prototype.refreshMe=function(){this.options.player.percents=[];this.options.player.elapsedtime=0;this.options.player.mediaElement.load();this.options.player.mediaElement.play();return this;};b.prototype.stop=function(){this.pause();return this;};b.prototype.play=function(){this.options.player.mediaElement.play();return this;};b.prototype.pause=function(){this.options.player.mediaElement.pause();return this;};b.prototype.remove=function(){this.options.player.mediaElement.remove();return this;};b.prototype.setupTranscript=function(){var C=this;this.$cache.el.on("click","."+this.options.classes.transcriptCTA,function(D){s.call(C,D,this);});};if(k.config.vidAutoInit){j(".chrysler-video").each(function(){if(!j.data(this,a)){j.data(this,a,new b(this,{player:{plugins:(j(this).data("type")==="video/mp4")?["flash","youtube","vimeo","silverlight"]:["youtube","flash","vimeo","silverlight"]}}));}});}return b;}(jQuery,Chrysler,window));